<script src="~/AppScripts/question.js" type="text/javascript" ></script>
<script src="~/AppScripts/wall.js" type="text/javascript" ></script>
<script src="~/AppScripts/ball.js" type="text/javascript" ></script>
<script src="~/AppScripts/game.js" type="text/javascript" ></script>
<style type="text/css">
    #start {
        width:30px;
        height:450px;
        background-color:aqua;
        float:left;
        }
    #gameArea {
        width:720px;
        height:450px;
        background-color:azure;
        float:left;

    }
    #wall {
        width: 65px;
        height: 450px;
        background-image: url('/Content/net.jpg');
        float:left;
        }
    .ball {
        border-radius: 35px;
        position: fixed;
        background-color: lightblue;
        height:55px;
        width:55px;
        text-align:center;
        vertical-align:middle;
        color:black;
        font-weight:bold;
        border-style:outset;
        border-color:transparent;
    }
    #solution, #bStart, #bStop, #bPause {
        font-size:larger;
        padding-left:20px;
        vertical-align:middle;
        height:30px;
        font-family:Georgia;
        font-weight:bolder;
     }
    #missed, #correct {
        float:left;
        width:20%;
        border:1px solid black;
        margin:5px;
    }
    tr{
        border-bottom:1px solid black;
    }
</style>
@{
    ViewBag.Title = "Play";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Play</h2>
<div class="ball" style="display:none;top:0px;left:770px;">test</div>
<input type="text" id="solution" />
<input type="button" id="bStart" onclick="Start(this);" value="Start" />
<input type="button" id="bPause" onclick="Start(this);" value="Pause" />
<input type="button" id="bStop" onclick="Stop(this);" value="Stop" />
<br />
<div id="start"></div>
<div id="gameArea"></div>
<div id="wall"></div>
<hr style="clear:both;" />
<table id="missed">
    <caption>Missed Questions</caption>
    <thead>
        <tr><th>Num1</th><th>Num2</th><th>Op</th><th>Ans</th></tr>
    </thead>
</table>
<table id="correct">
    <caption>Correct Questions</caption>
    <thead>
        <tr><th>Num1</th><th>Num2</th><th>Op</th><th>Ans</th></tr>
    </thead>
</table>
<script type="text/javascript">
    var theGame = null;
    function Start(sender) {
        var startWall = document.getElementById("start");
        var wall = document.getElementById("wall");
        var ballHeight = document.getElementsByClassName("ball")[0].style.height;
        var sendFrequency = 5000;
        theGame = new Game(startWall, wall, ballHeight, sendFrequency);
        document.onkeyup = function (evt) { handleKeyUp(evt,theGame); };
        theGame.start();
    }
    function showResult() {
        for (var i = 0; i < theGame.collidedBalls.length; i++) {
            var q = theGame.collidedBalls[i].question;
            var table = document.getElementById("missed");
            var row = table.insertRow(1);
            row.innerHTML = '<td>' + q.num1.toString() + '</td>'
                + '<td>' + q.num2.toString() + '</td>'
                + '<td>' + ops[q.op].toString() + '</td>'
                + '<td>' + q.ans.toString() + '</td>';
        }
        for (var i = 0; i < theGame.solvedBalls.length; i++) {
            var q = theGame.solvedBalls[i].question;
            var table = document.getElementById("correct");
            var row = table.insertRow(1);
            row.innerHTML = '<td>' + q.num1.toString() + '</td>'
                + '<td>' + q.num2.toString() + '</td>'
                + '<td>' + ops[q.op].toString() + '</td>'
                + '<td>' + q.ans.toString() + '</td>';
        }
    }
    
    function Stop(sender) {
        theGame.stopGame();
        showResult();
    }
    function Pause(sender) {
        if (theGame.pause) {
            theGame.resumeGame();
            sender.value = "Pause";
        } else {
            theGame.pauseGame();
            sender.value = "Resume";
        }
    }
    function handleKeyUp(evt,game) {
        //console.log(evt);
        //console.log(game);
        document.getElementById("solution").focus();
        if (evt.keyCode == 13) {
            //console.log(document.getElementById("solution").value);
            var answer = parseInt(document.getElementById("solution").value);
            if (!isNaN(answer)) {
                if (game.checkSolution(answer)) {

                } else {

                }
            }
            document.getElementById("solution").value = "";
            document.getElementById("solution").focus();
        }
    }
</script>